import{r as v,j as e}from"./index-DXUichdn.js";import{a as O,u as A,g as F,c as C}from"./KcPage-DTvYue0j.js";import{w as S}from"./waitForElementMountedOnDom-qpCjLZnq.js";O();O();function w(p){const{webAuthnButtonId:r,kcContext:o,i18n:c}=p,{url:u,isUserIdentified:j,challenge:m,userVerification:s,rpId:a,createTimeout:t}=o,{msgStr:l,isFetchingTranslations:d}=c,{insertScriptTags:h}=A({componentOrHookName:"LoginUsername",scriptTags:[{type:"module",textContent:()=>`

                    import { authenticateByWebAuthn } from "${u.resourcesPath}/js/webauthnAuthenticate.js";
                    const authButton = document.getElementById('${r}');
                    authButton.addEventListener("click", function() {
                        const input = {
                            isUserIdentified : ${j},
                            challenge : '${m}',
                            userVerification : '${s}',
                            rpId : '${a}',
                            createTimeout : ${t},
                            errmsg : ${JSON.stringify(l("webauthn-unsupported-browser-text"))}
                        };
                        authenticateByWebAuthn(input);
                    });
                `}]});v.useEffect(()=>{d||(async()=>(await S({elementId:r}),h()))()},[d])}function U(p){var r;const{kcContext:o,i18n:c,doUseDefaultCss:u,Template:j,classes:m}=p,{kcClsx:s}=F({doUseDefaultCss:u,classes:m}),{social:a,realm:t,url:l,usernameHidden:d,login:h,registrationDisabled:y,messagesPerField:g,enableWebAuthnConditionalUI:I,authenticators:x}=o,{msg:i,msgStr:k}=c,[N,B]=v.useState(!1),f="authenticateWebAuthnButton";return w({webAuthnButtonId:f,kcContext:o,i18n:c}),e.jsxs(j,Object.assign({kcContext:o,i18n:c,doUseDefaultCss:u,classes:m,displayMessage:!g.existsError("username"),displayInfo:t.password&&t.registrationAllowed&&!y,infoNode:e.jsx("div",Object.assign({id:"kc-registration"},{children:e.jsxs("span",{children:[i("noAccount"),e.jsx("a",Object.assign({tabIndex:6,href:l.registrationUrl},{children:i("doRegister")}))]})})),headerNode:i("doLogIn"),socialProvidersNode:e.jsx(e.Fragment,{children:t.password&&(a==null?void 0:a.providers)!==void 0&&a.providers.length!==0&&e.jsxs("div",Object.assign({id:"kc-social-providers",className:s("kcFormSocialAccountSectionClass")},{children:[e.jsx("hr",{}),e.jsx("h2",{children:i("identity-provider-login-label")}),e.jsx("ul",Object.assign({className:s("kcFormSocialAccountListClass",a.providers.length>3&&"kcFormSocialAccountListGridClass")},{children:a.providers.map((...[n,,b])=>e.jsx("li",{children:e.jsxs("a",Object.assign({id:`social-${n.alias}`,className:s("kcFormSocialAccountListButtonClass",b.length>3&&"kcFormSocialAccountGridItem"),type:"button",href:n.loginUrl},{children:[n.iconClasses&&e.jsx("i",{className:C(s("kcCommonLogoIdP"),n.iconClasses),"aria-hidden":"true"}),e.jsx("span",Object.assign({className:C(s("kcFormSocialAccountNameClass"),n.iconClasses&&"kc-social-icon-text")},{children:n.displayName}))]}))},n.alias))}))]}))})},{children:[e.jsx("div",Object.assign({id:"kc-form"},{children:e.jsx("div",Object.assign({id:"kc-form-wrapper"},{children:t.password&&e.jsxs("form",Object.assign({id:"kc-form-login",onSubmit:()=>(B(!0),!0),action:l.loginAction,method:"post"},{children:[!d&&e.jsxs("div",Object.assign({className:s("kcFormGroupClass")},{children:[e.jsx("label",Object.assign({htmlFor:"username",className:s("kcLabelClass")},{children:t.loginWithEmailAllowed?t.registrationEmailAsUsername?i("email"):i("usernameOrEmail"):i("username")})),e.jsx("input",{tabIndex:2,id:"username",className:s("kcInputClass"),name:"username",defaultValue:(r=h.username)!==null&&r!==void 0?r:"",type:"text",autoFocus:!0,autoComplete:"username","aria-invalid":g.existsError("username")}),g.existsError("username")&&e.jsx("span",Object.assign({id:"input-error",className:s("kcInputErrorMessageClass"),"aria-live":"polite"},{children:g.getFirstError("username")}))]})),e.jsx("div",Object.assign({className:s("kcFormGroupClass","kcFormSettingClass")},{children:e.jsx("div",Object.assign({id:"kc-form-options"},{children:t.rememberMe&&!d&&e.jsx("div",Object.assign({className:"checkbox"},{children:e.jsxs("label",{children:[e.jsx("input",{tabIndex:3,id:"rememberMe",name:"rememberMe",type:"checkbox",defaultChecked:!!h.rememberMe})," ",i("rememberMe")]})}))}))})),e.jsx("div",Object.assign({id:"kc-form-buttons",className:s("kcFormGroupClass")},{children:e.jsx("input",{tabIndex:4,disabled:N,className:s("kcButtonClass","kcButtonPrimaryClass","kcButtonBlockClass","kcButtonLargeClass"),name:"login",id:"kc-login",type:"submit",value:k("doLogIn")})}))]}))}))})),I&&e.jsxs(e.Fragment,{children:[e.jsxs("form",Object.assign({id:"webauth",action:l.loginAction,method:"post"},{children:[e.jsx("input",{type:"hidden",id:"clientDataJSON",name:"clientDataJSON"}),e.jsx("input",{type:"hidden",id:"authenticatorData",name:"authenticatorData"}),e.jsx("input",{type:"hidden",id:"signature",name:"signature"}),e.jsx("input",{type:"hidden",id:"credentialId",name:"credentialId"}),e.jsx("input",{type:"hidden",id:"userHandle",name:"userHandle"}),e.jsx("input",{type:"hidden",id:"error",name:"error"})]})),x!==void 0&&x.authenticators.length!==0&&e.jsx(e.Fragment,{children:e.jsx("form",Object.assign({id:"authn_select",className:s("kcFormClass")},{children:x.authenticators.map((n,b)=>e.jsx("input",{type:"hidden",name:"authn_use_chk",readOnly:!0,value:n.credentialId},b))}))}),e.jsx("br",{}),e.jsx("input",{id:f,type:"button",className:s("kcButtonClass","kcButtonDefaultClass","kcButtonBlockClass","kcButtonLargeClass"),value:k("passkey-doAuthenticate")})]})]}))}export{U as default};
