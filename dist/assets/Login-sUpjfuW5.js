import{r as f,j as s}from"./index-DHnbi08M.js";import{a as v,u as A,g as B,c as I,k}from"./KcPage-Dvq7vX86.js";import{u as E}from"./useIsPasswordRevealed-GGtQAsRm.js";import{w as L}from"./waitForElementMountedOnDom-qpCjLZnq.js";v();v();function P(h){const{webAuthnButtonId:t,kcContext:c,i18n:i}=h,{url:u,isUserIdentified:g,challenge:l,userVerification:e,rpId:o,createTimeout:a}=c,{msgStr:m,isFetchingTranslations:p}=i,{insertScriptTags:j}=A({componentOrHookName:"Login",scriptTags:[{type:"module",textContent:()=>`

                    import { authenticateByWebAuthn } from "${u.resourcesPath}/js/webauthnAuthenticate.js";
                    const authButton = document.getElementById('${t}');
                    authButton.addEventListener("click", function() {
                        const input = {
                            isUserIdentified : ${g},
                            challenge : '${l}',
                            userVerification : '${e}',
                            rpId : '${o}',
                            createTimeout : ${a},
                            errmsg : ${JSON.stringify(m("webauthn-unsupported-browser-text"))}
                        };
                        authenticateByWebAuthn(input);
                    });
                `}]});f.useEffect(()=>{p||(async()=>(await L({elementId:t}),j()))()},[p])}function $(h){var t;const{kcContext:c,i18n:i,doUseDefaultCss:u,Template:g,classes:l}=h,{kcClsx:e}=B({doUseDefaultCss:u,classes:l}),{social:o,realm:a,url:m,usernameHidden:p,login:j,auth:y,registrationDisabled:O,messagesPerField:d,enableWebAuthnConditionalUI:N,authenticators:x}=c,{msg:n,msgStr:C}=i,[F,S]=f.useState(!1),w="authenticateWebAuthnButton";return P({webAuthnButtonId:w,kcContext:c,i18n:i}),s.jsxs(g,Object.assign({kcContext:c,i18n:i,doUseDefaultCss:u,classes:l,displayMessage:!d.existsError("username","password"),headerNode:n("loginAccountTitle"),displayInfo:a.password&&a.registrationAllowed&&!O,infoNode:s.jsx("div",Object.assign({id:"kc-registration-container"},{children:s.jsx("div",Object.assign({id:"kc-registration"},{children:s.jsxs("span",{children:[n("noAccount")," ",s.jsx("a",Object.assign({tabIndex:8,href:m.registrationUrl},{children:n("doRegister")}))]})}))})),socialProvidersNode:s.jsx(s.Fragment,{children:a.password&&(o==null?void 0:o.providers)!==void 0&&o.providers.length!==0&&s.jsxs("div",Object.assign({id:"kc-social-providers",className:e("kcFormSocialAccountSectionClass")},{children:[s.jsx("hr",{}),s.jsx("h2",{children:n("identity-provider-login-label")}),s.jsx("ul",Object.assign({className:e("kcFormSocialAccountListClass",o.providers.length>3&&"kcFormSocialAccountListGridClass")},{children:o.providers.map((...[r,,b])=>s.jsx("li",{children:s.jsxs("a",Object.assign({id:`social-${r.alias}`,className:e("kcFormSocialAccountListButtonClass",b.length>3&&"kcFormSocialAccountGridItem"),type:"button",href:r.loginUrl},{children:[r.iconClasses&&s.jsx("i",{className:I(e("kcCommonLogoIdP"),r.iconClasses),"aria-hidden":"true"}),s.jsx("span",{className:I(e("kcFormSocialAccountNameClass"),r.iconClasses&&"kc-social-icon-text"),dangerouslySetInnerHTML:{__html:k(r.displayName)}})]}))},r.alias))}))]}))})},{children:[s.jsx("div",Object.assign({id:"kc-form"},{children:s.jsx("div",Object.assign({id:"kc-form-wrapper"},{children:a.password&&s.jsxs("form",Object.assign({id:"kc-form-login",onSubmit:()=>(S(!0),!0),action:m.loginAction,method:"post"},{children:[!p&&s.jsxs("div",Object.assign({className:e("kcFormGroupClass")},{children:[s.jsx("label",Object.assign({htmlFor:"username",className:e("kcLabelClass")},{children:a.loginWithEmailAllowed?a.registrationEmailAsUsername?n("email"):n("usernameOrEmail"):n("username")})),s.jsx("input",{tabIndex:2,id:"username",className:e("kcInputClass"),name:"username",defaultValue:(t=j.username)!==null&&t!==void 0?t:"",type:"text",autoFocus:!0,autoComplete:"username","aria-invalid":d.existsError("username","password")}),d.existsError("username","password")&&s.jsx("span",{id:"input-error",className:e("kcInputErrorMessageClass"),"aria-live":"polite",dangerouslySetInnerHTML:{__html:k(d.getFirstError("username","password"))}})]})),s.jsxs("div",Object.assign({className:e("kcFormGroupClass")},{children:[s.jsx("label",Object.assign({htmlFor:"password",className:e("kcLabelClass")},{children:n("password")})),s.jsx(M,Object.assign({kcClsx:e,i18n:i,passwordInputId:"password"},{children:s.jsx("input",{tabIndex:3,id:"password",className:e("kcInputClass"),name:"password",type:"password",autoComplete:"current-password","aria-invalid":d.existsError("username","password")})})),p&&d.existsError("username","password")&&s.jsx("span",{id:"input-error",className:e("kcInputErrorMessageClass"),"aria-live":"polite",dangerouslySetInnerHTML:{__html:k(d.getFirstError("username","password"))}})]})),s.jsxs("div",Object.assign({className:e("kcFormGroupClass","kcFormSettingClass")},{children:[s.jsx("div",Object.assign({id:"kc-form-options"},{children:a.rememberMe&&!p&&s.jsx("div",Object.assign({className:"checkbox"},{children:s.jsxs("label",{children:[s.jsx("input",{tabIndex:5,id:"rememberMe",name:"rememberMe",type:"checkbox",defaultChecked:!!j.rememberMe})," ",n("rememberMe")]})}))})),s.jsx("div",Object.assign({className:e("kcFormOptionsWrapperClass")},{children:a.resetPasswordAllowed&&s.jsx("span",{children:s.jsx("a",Object.assign({tabIndex:6,href:m.loginResetCredentialsUrl},{children:n("doForgotPassword")}))})}))]})),s.jsxs("div",Object.assign({id:"kc-form-buttons",className:e("kcFormGroupClass")},{children:[s.jsx("input",{type:"hidden",id:"id-hidden-input",name:"credentialId",value:y.selectedCredential}),s.jsx("input",{tabIndex:7,disabled:F,className:e("kcButtonClass","kcButtonPrimaryClass","kcButtonBlockClass","kcButtonLargeClass"),name:"login",id:"kc-login",type:"submit",value:C("doLogIn")})]}))]}))}))})),N&&s.jsxs(s.Fragment,{children:[s.jsxs("form",Object.assign({id:"webauth",action:m.loginAction,method:"post"},{children:[s.jsx("input",{type:"hidden",id:"clientDataJSON",name:"clientDataJSON"}),s.jsx("input",{type:"hidden",id:"authenticatorData",name:"authenticatorData"}),s.jsx("input",{type:"hidden",id:"signature",name:"signature"}),s.jsx("input",{type:"hidden",id:"credentialId",name:"credentialId"}),s.jsx("input",{type:"hidden",id:"userHandle",name:"userHandle"}),s.jsx("input",{type:"hidden",id:"error",name:"error"})]})),x!==void 0&&x.authenticators.length!==0&&s.jsx(s.Fragment,{children:s.jsx("form",Object.assign({id:"authn_select",className:e("kcFormClass")},{children:x.authenticators.map((r,b)=>s.jsx("input",{type:"hidden",name:"authn_use_chk",readOnly:!0,value:r.credentialId},b))}))}),s.jsx("br",{}),s.jsx("input",{id:w,type:"button",className:e("kcButtonClass","kcButtonDefaultClass","kcButtonBlockClass","kcButtonLargeClass"),value:C("passkey-doAuthenticate")})]})]}))}function M(h){const{kcClsx:t,i18n:c,passwordInputId:i,children:u}=h,{msgStr:g}=c,{isPasswordRevealed:l,toggleIsPasswordRevealed:e}=E({passwordInputId:i});return s.jsxs("div",Object.assign({className:t("kcInputGroup")},{children:[u,s.jsx("button",Object.assign({type:"button",className:t("kcFormPasswordVisibilityButtonClass"),"aria-label":g(l?"hidePassword":"showPassword"),"aria-controls":i,onClick:e},{children:s.jsx("i",{className:t(l?"kcFormPasswordVisibilityIconHide":"kcFormPasswordVisibilityIconShow"),"aria-hidden":!0})}))]}))}export{$ as default};
